namespace = me_subject_independence

## Mission 1 - Internal discussion of independence - start
me_subject_independence.1 = {	# Initial event
    type = country_event
    title = me_subject_independence.1.t
    desc = me_subject_independence.1.desc
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = scope:random_left_advisor
	right_portrait = scope:random_right_advisor

    option = {      
        name = me_subject_independence.1.a
		custom_tooltip = me_subject_independence.1.at
    }
}

me_subject_independence.2 = {	# Discussion which path should be taken
	type = country_event
	hidden = yes

	immediate = {
		if = {	# Discussion continues
			limit = {
				var:discussion_progress < 5
				is_subject = yes
			}
			random_list = {
				1 = {	# Complication event - Left side forces their argument
					trigger = {
						NOT = {
							has_variable = left_forced
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_forced
						days = 60
					}
					change_variable = {
						name = left_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.3
					}
				}
				1 = {	# Complication event - Right side forces their argument
					trigger = {
						NOT = {
							has_variable = right_forced
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_forced
						days = 40
					}
					change_variable = {
						name = right_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.3
					}
				}
				2 = {	# Complication event - Left side objects
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					trigger_event = {
						id = me_subject_independence.4
					}
				}
				2 = {	# Complication event - Right side objects
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					trigger_event = {
						id = me_subject_independence.4
					}
				}
				2 = {	# Complication event - Left side bribes
					trigger = {
						NOT = {
							has_variable = left_bribed
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_bribed
						days = 180
					}
					trigger_event = {
						id = me_subject_independence.5
					}
				}
				2 = {	# Complication event - Right side bribes
					trigger = {
						NOT = {
							has_variable = right_bribed
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_bribed
						days = 180
					}
					trigger_event = {
						id = me_subject_independence.5
					}
				}
				2 = {	# Complication event - Left side brilliant speech
					trigger = {
						NOT = {
							has_variable = left_speeched
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_speeched
						days = 180
					}
					trigger_event = {
						id = me_subject_independence.6
					}
				}
				2 = {	# Complication event - Right side brilliant speech
					trigger = {
						NOT = {
							has_variable = right_speeched
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_speeched
						days = 180
					}
					trigger_event = {
						id = me_subject_independence.6
					}
				}
				1 = {	# Complication event - Left side makes promises
					trigger = {
						NOT = {
							has_variable = left_promised
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_promised
						days = 180
					}
					change_variable = {
						name = left_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.7
					}
				}
				1 = {	# Complication event - Right side makes promises
					trigger = {
						NOT = {
							has_variable = right_promised
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_promised
						days = 180
					}
					change_variable = {
						name = right_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.7
					}
				}
			}
			change_variable = {
				name = discussion_progress
				add = 1
			}
			trigger_event = {
				id = me_subject_independence.2
				days = { 25 30 }
			}
		}
		else_if = {	# Discussion finished
			limit = {
				var:discussion_progress >= 5
				is_subject = yes
			}
			if = {	# Left side superior
				limit = {
					var:left_argument_points > var:right_argument_points
				}
				set_variable = {
					name = left_won
				}
			}
			else_if = {	# Right side superior
				limit = {
					var:left_argument_points < var:right_argument_points
				}
				set_variable = {
					name = right_won
				}
			}
			else = {	# Stalemate
				set_variable = {
					name = stalemate_won
				}
			}
			hidden_effect = {
				remove_variable = discussion_progress
				remove_variable = left_argument_points
				remove_variable = right_argument_points
			}
		}
		else = {	# Fallback cleanup
			hidden_effect = {
				remove_variable = discussion_progress
				remove_variable = left_argument_points
				remove_variable = right_argument_points
			}
		}
	}
}

me_subject_independence.3 = {	# Discussion event - A side forces their argument
	type = country_event
	title = me_subject_independence.3.t
    desc = {
		desc = me_subject_independence.3.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_variable = left_check
				}
				desc = me_subject_independence.3.desc_l
			}
			triggered_desc = {
				trigger = {
					has_variable = right_check
				}
				desc = me_subject_independence.3.desc_r
			}
		}
	}
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor
	
	option = {
		name = me_subject_independence.3.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.3.at_l
		}
		else = {
			custom_tooltip = me_subject_independence.3.at_r
		}
	}
}

me_subject_independence.4 = {	# Discussion event - A side objects
	type = country_event
	title = me_subject_independence.4.t
    desc = {
		desc = me_subject_independence.4.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_variable = left_check
				}
				desc = me_subject_independence.4.desc_l
			}
			triggered_desc = {
				trigger = {
					has_variable = right_check
				}
				desc = me_subject_independence.4.desc_r
			}
		}
	}
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {	# Agree with the objecting side
		name = me_subject_independence.4.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.4.at_l
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.4.at_r
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = advisor_agree_pos_loyalty
		}
	}

	option = {	# Disagree with the objecting side
		name = me_subject_independence.4.b
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.4.bt_l
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.4.bt_r
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = advisor_deny_neg_loyalty
		}
	}
}

me_subject_independence.5 = {	# Discussion event - A side attempts a bribe
	type = country_event
	title = me_subject_independence.5.t
    desc = me_subject_independence.5.desc
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {	# Take the bribe
		name = me_subject_independence.5.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.5.at_l
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.5.at_r
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_gold = -200
			add_loyalty = advisor_agree_pos_loyalty
		}
		current_ruler = {
			add_gold = 200
			add_popularity = subtract_popularity_large
			add_corruption = corruption_large
		}
	}

	option = {	# Don't take the bribe
		name = me_subject_independence.5.b
		custom_tooltip = me_subject_independence.5.bt
		scope:selected_advisor = {
			add_loyalty = advisor_deny_neg_loyalty
			add_popularity = subtract_popularity_large
		}
		current_ruler = {
			add_popularity = popularity_large
		}
	}
}

me_subject_independence.6 = {	# Discussion event - A side makes a brilliant speech
	type = country_event
	title = me_subject_independence.6.t
    desc = me_subject_independence.6.desc
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {	# Join in with popular opinion
		name = me_subject_independence.6.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.6.at_l
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.6.at_r
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = advisor_agree_pos_loyalty
		}
	}

	option = {	# Poke holes in flawed argument
		name = me_subject_independence.6.b
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.6.bt_l
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.6.bt_r
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = advisor_deny_neg_loyalty
		}
		current_ruler = {
			add_popularity = subtract_popularity_large
		}
	}
}

me_subject_independence.7 = {	# Discussion event - A side makes beautiful promises
	type = country_event
	title = me_subject_independence.7.t
    desc = {
		desc = me_subject_independence.7.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_variable = left_check
				}
				desc = me_subject_independence.7.desc_l
			}
			triggered_desc = {
				trigger = {
					has_variable = right_check
				}
				desc = me_subject_independence.7.desc_r
			}
		}
	}
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {
		name = me_subject_independence.7.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.7.at_l
		}
		else = {
			custom_tooltip = me_subject_independence.7.at_r
		}
	}
}

me_subject_independence.10 = {	# Resolution event - Left side wins
	type = country_event
	title = me_subject_independence.10.t
	desc = me_subject_independence.10.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = scope:random_left_advisor
	right_portrait = scope:random_right_advisor

	option = {
		name = me_subject_independence.10.a
		custom_tooltip = me_subject_independence.10.at
	}
}

me_subject_independence.11 = {	# Resolution event - Right side wins
	type = country_event
	title = me_subject_independence.11.t
	desc = me_subject_independence.11.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = scope:random_left_advisor
	right_portrait = scope:random_right_advisor

	option = {
		name = me_subject_independence.11.a
		custom_tooltip = me_subject_independence.11.at
	}
}

me_subject_independence.12 = {	# Resolution event - Stalemate
	type = country_event
	title = me_subject_independence.12.t
	desc = me_subject_independence.12.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = scope:random_left_advisor
	right_portrait = scope:random_right_advisor

	option = {
		name = me_subject_independence.12.a
		custom_tooltip = me_subject_independence.12.at
	}
}
## Mission 1 - Internal discussion of independence - end

## Mission 2 (Left) - Taking an agressive stance - start
me_subject_independence.13 = {	# Event for subject
	type = country_event
	title = me_subject_independence.13.t
	desc = me_subject_independence.13.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:random_left_advisor

	option = {
		name = me_subject_independence.13.a
		custom_tooltip = me_subject_independence.13.at
	}
}

me_subject_independence.14 = {	# Event for overlord
	type = country_event
	title = me_subject_independence.14.t
	desc = me_subject_independence.14.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:unwilling_subject.current_ruler

	option = {
		name = me_subject_independence.14.a
		custom_tooltip = me_subject_independence.14.at
	}
}
## Mission 2 (Left) - Taking an agressive stance - end

## Mission 5 (Left) - Preparing Character - start
me_subject_independence.15 = {
	type = country_event
	title = me_subject_independence.15.t
	desc = me_subject_independence.15.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler

	option = {
		name = me_subject_independence.15.a
		custom_tooltip = me_subject_independence.15.at
	}
}

me_subject_independence.16 = {	# Choice of Price maintenance event
	type = country_event
	hidden = yes

	immediate = {
		if = {
			limit = {
				AND = {
					var:fh_progress < 3
					list_size = {
						name = family_heads_list
						value > 0
					}
				}
			}
			random_in_list = {
				list = family_heads_list
				save_scope_as = selected_family_head
				scope:selected_family_head = {
					remove_from_list = family_heads_list
				}
			}
			random_list = {
				2 = {	# Asking for a bribe
					trigger_event = {
						id = me_subject_independence.17
					}
				}
				2 = {	# Asking for holdings
					trigger = {
						total_holdings >= 5
					}
					trigger_event = {
						id = me_subject_independence.18
					}
				}
				2 = {	# Asking for minor advisory roles
					trigger_event = {
						id = me_subject_independence.19
					}
				}
				1 = {	# Asking for nothing
					trigger_event = {
						id = me_subject_independence.20
					}
				}
			}
			trigger_event = {
				id = me_subject_independence.16
				days = 15
			}
			change_variable = {
				name = fh_progress
				add = 1
			}
		}
		else = {	# Cleanup
			remove_variable = fh_progress
		}
	}
}

me_subject_independence.17 = {	# Choice Event - FH asks for a bribe
	type = country_event
	title = me_subject_independence.17.t
	desc = me_subject_independence.17.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_family_head

	option = {	# Give them the bribe
		name = me_subject_independence.17.a
		add_treasury = -100
		scope:selected_family_head = {
			add_gold = 100
			add_corruption = corruption_large
			add_loyalty = family_head_pos_loyalty
		}
	}

	option = {	# Deny the bribe
		name = me_subject_independence.17.b
		scope:selected_family_head = {
			add_loyalty = family_head_neg_loyalty
		}
		hidden_effect = {
			scope:selected_family_head = {
				set_variable = {
					name = spurned_var
				}
			}
		}
	}
}

me_subject_independence.18 = {	# Choice Event - FH asks for holdings
	type = country_event
	title = me_subject_independence.18.t
	desc = me_subject_independence.18.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_family_head

	option = {	# Give them the holdings
		name = me_subject_independence.18.a
		while = {
			count = 5
			random_owned_province = {
				save_scope_as = tmp_holding_scope
			}
			scope:selected_family_head = {
				add_holding = scope:tmp_holding_scope
			}
		}
		scope:selected_family_head = {
			add_corruption = corruption_large
			add_loyalty = family_head_pos_loyalty
		}
	}

	option = {	# Deny the holdings
		name = me_subject_independence.18.b
		scope:selected_family_head = {
			add_loyalty = family_head_neg_loyalty
		}
		hidden_effect = {
			scope:selected_family_head = {
				set_variable = {
					name = spurned_var
				}
			}
		}
	}
}

me_subject_independence.19 = {	# Choice Event - FH asks for minor advisor roles
	type = country_event
	title = me_subject_independence.19.t
	desc = me_subject_independence.19.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_family_head

	option = {	# Give them the advisor titles
		name = me_subject_independence.19.a
		# TODO add the advisor status on a couple of adult characters in the family
		scope:selected_family_head = {
			add_character_modifier = {
				name = me_subject_advisor_charmod
				duration = 3650
			}
			next_in_family = {
				add_character_modifier = {
					name = me_subject_advisor_charmod
					duration = 3650
				}
				next_in_family = {
					add_character_modifier = {
						name = me_subject_advisor_charmod
						duration = 3650
					}
				}
			}
			add_corruption = corruption_large
			add_loyalty = family_head_pos_loyalty
		}
	}

	option = {	# Deny the titles
		name = me_subject_independence.19.b
		scope:selected_family_head = {
			add_loyalty = family_head_neg_loyalty
		}
		hidden_effect = {
			scope:selected_family_head = {
				set_variable = {
					name = spurned_var
				}
			}
		}
	}
}

me_subject_independence.20 = {	# Choice Event - FH asks for nothing
	type = country_event
	title = me_subject_independence.20.t
	desc = me_subject_independence.20.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_family_head

	option = {
		name = me_subject_independence.20.a
		scope:selected_family_head = {
			add_loyalty = family_head_pos_loyalty
		}
	}
}

me_subject_independence.21 = {	# Conluding task
	type = country_event
	title = me_subject_independence.21.t
	desc = me_subject_independence.21.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler

	option = {
		name = me_subject_independence.21.a
	}
}
## Mission 5 (Left) - Preparing Character - start

## Mission 6 (Left) - Making Allies - start
me_subject_independence.25 = {	# Event to send gold or no to possible ally
	type = country_event
	title = me_subject_independence.25.t
	desc = me_subject_independence.25.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:tmp_ally_scope.current_ruler

	option = {	# Ask with gold
		name = me_subject_independence.25.a
		custom_tooltip = me_subject_independence.25.at
		add_treasury = -100
		scope:tmp_ally_scope = {
			set_variable = {
				name = tempting_offer_made
				days = 30
			}
			trigger_event = {
				id = me_subject_independence.26
				days = { 3 7 }
			}
		}
	}

	option = {	# Ask
		name = me_subject_independence.25.b
		custom_tooltip = me_subject_independence.25.bt
		scope:tmp_ally_scope = {
			trigger_event = {
				id = me_subject_independence.26
				days = { 3 7 }
			}
		}
	}

	option = {	# Don't ask
		name = me_subject_independence.25.c
		custom_tooltip = me_subject_independence.25.ct
	}
}

me_subject_independence.26 = {	# Potential ally gets the event
	type = country_event
	title = me_subject_independence.26.t
	desc = {
		desc = me_subject_independence.26.desc
		triggered_desc = {
			trigger = {
				has_variable = tempting_offer_made
			}
			desc = me_subject_independence.26.desc_1
		}
	}
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:unwilling_subject.current_ruler
	right_portrait = scope:our_overlord.current_ruler

	immediate = {
		if = {
			limit = {
				has_variable = tempting_offer_made
			}
			add_treasury = 100
		}
	}

	option = {	# Accept the offer
		name = me_subject_independence.26.a
		custom_tooltip = me_subject_independence.26.at
		set_variable = {
			name = pledged_support
		}
		scope:unwilling_subject = {
			trigger_event = {
				id = me_subject_independence.27
				days = { 3 7 }
			}
		} # TODO ai chance calculation
	}

	option = {	# Decline the offer
		name = me_subject_independence.26.b
		custom_tooltip = me_subject_independence.26.bt
		scope:unwilling_subject = {
			trigger_event = {
				id = me_subject_independence.28
				days = { 3 7 }
			}
		} # TODO ai chance calculation
	}
}

me_subject_independence.27 = {	# Potential ally accepted
	type = country_event
	title = me_subject_independence.27.t
	desc = me_subject_independence.27.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	left_portrait = scope:tmp_ally_scope.current_ruler
	right_portrait = scope:our_overlord.current_ruler

	option = {	# Okay
		name = me_subject_independence.27.a
	}
}

me_subject_independence.28 = {	# Potential ally declined
	type = country_event
	title = me_subject_independence.28.t
	desc = me_subject_independence.28.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:tmp_ally_scope.current_ruler

	option = {	# Okay
		name = me_subject_independence.28.a
	}
}
## Mission 6 (Left) - Making Allies - end

## Mission 7 (Left) - Asking for Favours - start
me_subject_independence.30 = {	# Main event
	type = country_event
	title = me_subject_independence.30.t
	desc = me_subject_independence.30.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = scope:selected_family_head
	left_portrait = scope:selected_friendly_neighbour.current_ruler
	right_portrait = scope:selected_office_boy
	right_portrait = scope:selected_high_priest

	option = {	# Gold from a family head
		trigger = {
			NOT = {
				has_variable = asked_gold
			}
		}
		name = me_subject_independence.30.a
		custom_tooltip = me_subject_independence.30.at
		hidden_effect = {
			set_variable = {
				name = asked_gold
			}
			trigger_event = {
				id = me_subject_independence.31
			}
		}
	}

	option = {	# Manpower from neighbouring friendly nation
		trigger = {
			NOT = {
				has_variable = asked_manpower
			}
		}
		name = me_subject_independence.30.b
		custom_tooltip = me_subject_independence.30.bt
		hidden_effect = {
			set_variable = {
				name = asked_manpower
			}
			scope:selected_friendly_neighbour = {
				trigger_event = {
					id = me_subject_independence.32
				}
			}
		}
	}

	option = {	# Influence from character in your government
		trigger = {
			NOT = {
				has_variable = asked_influence
			}
		}
		name = me_subject_independence.30.c
		custom_tooltip = me_subject_independence.30.ct
		hidden_effect = {
			set_variable = {
				name = asked_influence
			}
			trigger_event = {
				id = me_subject_independence.34
			}
		}
	}

	option = {	# Stability from religious head
		trigger = {
			NOT = {
				has_variable = asked_stab
			}
		}
		name = me_subject_independence.30.d
		custom_tooltip = me_subject_independence.30.dt
		hidden_effect = {
			set_variable = {
				name = asked_stab
			}
			trigger_event = {
				id = me_subject_independence.35
			}
		}
	}

	option = {	# Stop asking for things
		name = me_subject_independence.30.e
		hidden_effect = {
			remove_variable = asked_gold
			remove_variable = asked_manpower
			remove_variable = asked_influence
			remove_variable = asked_stab
		}
	}
}

me_subject_independence.31 = {	# Got money
	type = country_event
	title = me_subject_independence.31.t
	desc = me_subject_independence.31.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_family_head

	option = {
		name = me_subject_independence.31.a
		add_treasury = 100
		scope:selected_family_head = {
			add_gold = -100
			add_loyalty = favour_neg_loyalty
			set_variable = {
				name = spurned_var
			}
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						AND = {
							has_variable = asked_gold
							has_variable = asked_manpower
							has_variable = asked_influence
							has_variable = asked_stab
						}
					}
				}
				trigger_event = {
					id = me_subject_independence.30
					days = 1
				}
			}
			else = {
				remove_variable = asked_gold
				remove_variable = asked_manpower
				remove_variable = asked_influence
				remove_variable = asked_stab
			}
		}
	}
}

me_subject_independence.32 = {	# Request for manpower
	type = country_event
	title = me_subject_independence.32.t
	desc = me_subject_independence.32.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:unwilling_subject.current_ruler

	option = {	# A lot
		name = me_subject_independence.32.a
		add_manpower = -6
		scope:unwilling_subject = {
			show_as_tooltip = {
				add_manpower = 6
			}
			add_opinion = {
				target = root
				modifier = manpower_big_gift_pos_opmod
			}
		}
		hidden_effect = {
			scope:unwilling_subject = {
				set_variable = {
					name = got_a_lot
					days = 30
				}
			}
		}
	}

	option = {	# A bit
		name = me_subject_independence.32.b
		add_manpower = -3
		scope:unwilling_subject = {
			show_as_tooltip = {
				add_manpower = 3
			}
			add_opinion = {
				target = root
				modifier = manpower_gift_pos_opmod
			}
		}
		hidden_effect = {
			scope:unwilling_subject = {
				set_variable = {
					name = got_a_bit
					days = 30
				}
			}
		}
	}

	option = {	# No
		name = me_subject_independence.32.c
		scope:unwilling_subject = {
			add_opinion = {
				target = root
				modifier = manpower_gift_neg_opmod
			}
		}
		hidden_effect = {
			scope:unwilling_subject = {
				set_variable = {
					name = got_a_no
					days = 30
				}
			}
		}
	}

	after = {
		hidden_effect = {
			scope:unwilling_subject = {
				trigger_event = {
					id = me_subject_independence.33
					days = 1
				}
			}
		}
	}
}

me_subject_independence.33 = {	# Got manpower
	type = country_event
	title = me_subject_independence.33.t
	desc = {
		desc = me_subject_independence.33.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_variable = got_a_lot
				}
				desc = me_subject_independence.33.desc_1
			}
			triggered_desc = {
				trigger = {
					has_variable = got_a_bit
				}
				desc = me_subject_independence.33.desc_1
			}
			triggered_desc = {
				trigger = {
					has_variable = got_a_no
				}
				desc = me_subject_independence.33.desc_1
			}
		}
	}
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_friendly_neighbour.current_ruler

	option = {
		trigger = {
			has_variable = got_a_lot
		}
		name = me_subject_independence.33.a
		add_manpower = 6
		scope:selected_friendly_neighbour = {
			add_opinion = {
				target = root
				modifier = manpower_big_gift_pos_opmod
			}
		}
	}

	option = {
		trigger = {
			has_variable = got_a_bit
		}
		name = me_subject_independence.33.b
		add_manpower = 3
		scope:selected_friendly_neighbour = {
			add_opinion = {
				target = root
				modifier = manpower_gift_pos_opmod
			}
		}
	}

	option = {
		trigger = {
			has_variable = got_a_no
		}
		name = me_subject_independence.33.c
		scope:selected_friendly_neighbour = {
			add_opinion = {
				target = root
				modifier = manpower_gift_neg_opmod
			}
		}
	}

	after = {
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						AND = {
							has_variable = asked_gold
							has_variable = asked_manpower
							has_variable = asked_influence
							has_variable = asked_stab
						}
					}
				}
				trigger_event = {
					id = me_subject_independence.30
					days = 1
				}
			}
			else = {
				remove_variable = asked_gold
				remove_variable = asked_manpower
				remove_variable = asked_influence
				remove_variable = asked_stab
			}
		}
	}
}

me_subject_independence.34 = {	# Got influence
	type = country_event
	title = me_subject_independence.34.t
	desc = me_subject_independence.34.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_office_boy

	option = {
		name = me_subject_independence.34.a
		add_political_influence = 50
		scope:selected_office_boy = {
			add_loyalty = favour_neg_loyalty
			set_variable = {
				name = spurned_var
			}
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						AND = {
							has_variable = asked_gold
							has_variable = asked_manpower
							has_variable = asked_influence
							has_variable = asked_stab
						}
					}
				}
				trigger_event = {
					id = me_subject_independence.30
					days = 1
				}
			}
			else = {
				remove_variable = asked_gold
				remove_variable = asked_manpower
				remove_variable = asked_influence
				remove_variable = asked_stab
			}
		}
	}
}

me_subject_independence.35 = {	# Got stability
	type = country_event
	title = me_subject_independence.35.t
	desc = me_subject_independence.35.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_high_priest

	option = {
		name = me_subject_independence.35.a
		add_stability = 15
		scope:selected_high_priest = {
			add_loyalty = favour_neg_loyalty
			set_variable = {
				name = spurned_var
			}
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						AND = {
							has_variable = asked_gold
							has_variable = asked_manpower
							has_variable = asked_influence
							has_variable = asked_stab
						}
					}
				}
				trigger_event = {
					id = me_subject_independence.30
					days = 1
				}
			}
			else = {
				remove_variable = asked_gold
				remove_variable = asked_manpower
				remove_variable = asked_influence
				remove_variable = asked_stab
			}
		}
	}
}
## Mission 7 (Left) - Asking for Favours - end

## Mission 9 (Left) - Final preparations - start
me_subject_independence.40 = {	# Initial event
	type = country_event
	title = me_subject_independence.40.t
	desc = me_subject_independence.40.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:our_overlord.current_ruler

	option = {
		name = me_subject_independence.40.a
	}
}

me_subject_independence.41 = {	# Manage event
	type = country_event
	hidden = yes

	immediate = {
		if = {	# Discussion continues
			limit = {
				var:discussion_progress < 5
				is_subject = yes
				list_size = {
					name = spurned_chars_list
					value > 0
				}
			}
			random_list = {
				1 = {	# Nothing happens
					# Do nothing TODO this might bug
					debug_log = Did_Nothing
				}
				1 = {	# Complication event - A character complains
					trigger = {
						NOT = {
							has_variable = check_complain
						}
					}
					set_variable = {
						name = check_complain
						days = 180
					}
					random_in_list = {
						list = spurned_chars_list
						save_scope_as = selected_spurned_character
						remove_from_list = spurned_chars_list
					}
					trigger_event = {
						id = me_subject_independence.42
					}
				}
				1 = {	# Complication event - A character sabotage
					trigger = {
						NOT = {
							has_variable = check_sabotage
						}
					}
					set_variable = {
						name = check_sabotage
						days = 180
					}
					random_in_list = {
						list = spurned_chars_list
						save_scope_as = selected_spurned_character
						remove_from_list = spurned_chars_list
					}
					trigger_event = {
						id = me_subject_independence.43
					}
				}
				1 = {	# Complication event - A character approaches you in private
					trigger = {
						NOT = {
							has_variable = check_approach
						}
					}
					set_variable = {
						name = check_approach
						days = 180
					}
					random_in_list = {
						list = spurned_chars_list
						save_scope_as = selected_spurned_character
						remove_from_list = spurned_chars_list
					}
					trigger_event = {
						id = me_subject_independence.44
					}
				}
			}
			change_variable = {
				name = discussion_progress
				add = 1
			}
			trigger_event = {
				id = me_subject_independence.41
				days = { 25 30 }
			}
		}
		else_if = {	# Discussion finished
			limit = {
				var:discussion_progress >= 5
				is_subject = yes
			}
			# TODO do something
			hidden_effect = {
				remove_variable = discussion_progress
			}
		}
		else = {	# Fallback cleanup
			hidden_effect = {
				remove_variable = discussion_progress
			}
		}
	}
}

me_subject_independence.42 = {	# Complication event - A spurned character complains
	type = country_event
	title = me_subject_independence.42.t
	desc = me_subject_independence.42.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_spurned_character

	immediate = {
		add_stability = -3
		scope:selected_spurned_character = {
			force_add_trait = depressed
		}
	}

	option = {
		name = me_subject_independence.42.a
		custom_tooltip = me_subject_independence.42.at
		add_political_influence = -10
		scope:selected_spurned_character = {
			add_loyalty = final_prep_neg_loyalty
		}
	}

	option = {
		name = me_subject_independence.42.b
		custom_tooltip = me_subject_independence.42.bt
		hidden_effect = {
			change_variable = {
				name = bad_boy_points
				add = -1
			}
		}
	}
}

me_subject_independence.43 = {	# Complication event - A spurned character sabotage
	type = country_event
	title = me_subject_independence.43.t
	desc = me_subject_independence.43.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_spurned_character

	immediate = {
		add_stability = -3
		scope:selected_spurned_character = {
			force_add_trait = orator
		}
	}

	option = {
		name = me_subject_independence.43.a
		custom_tooltip = me_subject_independence.43.at
		add_political_influence = -10
		scope:selected_spurned_character = {
			add_loyalty = final_prep_neg_loyalty
		}
	}

	option = {
		name = me_subject_independence.43.b
		custom_tooltip = me_subject_independence.42.bt
		hidden_effect = {
			change_variable = {
				name = bad_boy_points
				add = -1
			}
		}
	}
}

me_subject_independence.44 = {	# Complication event - A spurned character approaches in private
	type = country_event
	title = me_subject_independence.44.t
	desc = me_subject_independence.44.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:selected_spurned_character

	immediate = {
		add_stability = -3
		scope:selected_spurned_character = {
			force_add_trait = deceitful
		}
	}

	option = {
		name = me_subject_independence.44.a
		custom_tooltip = me_subject_independence.44.at
		add_political_influence = -10
		scope:selected_spurned_character = {
			add_loyalty = final_prep_neg_loyalty
		}
	}

	option = {
		name = me_subject_independence.44.b
		custom_tooltip = me_subject_independence.44.bt
		hidden_effect = {
			change_variable = {
				name = bad_boy_points
				add = -1
			}
		}
	}
}

me_subject_independence.45 = {	# Final event
	type = country_event
	title = me_subject_independence.45.t
	desc = me_subject_independence.45.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:our_overlord.current_ruler

	option = {
		name = me_subject_independence.45.a
	}
}
## Mission 9 (Left) - Final preparations - start

## Missions 3, 4, 8 (Left) - Informational Events - start
me_subject_independence.50 = {	# Mission 3 (Left) - Building defenses
	type = country_event
	title = me_subject_independence.50.t
	desc = me_subject_independence.50.desc
	picture = senate_debate	# TODO adjust for different governments and cultures

	immediate = {
		show_as_tooltip = {	# Done in missions (only informational)
			capital_scope = {
				add_province_modifier = {
					name = gm_subject_defensive_pmod
					duration = 5475	# 15 years
				}
			}
		}
	}

	option = {
		name = me_subject_independence.50.a
	}
}

me_subject_independence.51 = {	# Mission 4 (Left) - Army boon
	type = country_event
	title = me_subject_independence.51.t
	desc = me_subject_independence.51.desc
	picture = senate_debate	# TODO adjust for different governments and cultures

	immediate = {
		show_as_tooltip = {	# Done in missions (only informational)
			add_country_modifier = {
				name = gm_subject_army_cmod
				duration = 3650	# 10 years
			}
		}
	}

	option = {
		name = me_subject_independence.51.a
	}
}

me_subject_independence.52 = {	# Mission 8 (Left) - Navy boon
	type = country_event
	title = me_subject_independence.52.t
	desc = me_subject_independence.52.desc
	picture = senate_debate	# TODO adjust for different governments and cultures

	immediate = {
		show_as_tooltip = {	# Done in missions (only informational)
			add_country_modifier = {
				name = gm_subject_navy_cmod
				duration = 3650	# 10 years
			}
		}
	}

	option = {
		name = me_subject_independence.52.a
	}
}
## Missions 3, 4, 8 (Left) - Informational Events - end

## Mission 10 (Left) - Ultimatum - start
me_subject_independence.60 = {	# Initial event for subject
	type = country_event
	title = me_subject_independence.60.t
	desc = me_subject_independence.60.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:our_overlord.current_ruler

	option = {
		name = me_subject_independence.60.a
		custom_tooltip = me_subject_independence.60.at
	}
}

me_subject_independence.61 = {	# Decision event for overlord
	type = country_event
	title = me_subject_independence.61.t
	desc = me_subject_independence.61.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:unwilling_subject.current_ruler

	option = {	# Accept
		name = me_subject_independence.61.a
		custom_tooltip = me_subject_independence.61.at
		hidden_effect = {
			scope:unwilling_subject = {
				trigger_event = {
					id = me_subject_independence.62
				}
			}
		}
		# TODO ai calculation of this decision
	}

	option = {	# Deny
		name = me_subject_independence.61.b
		custom_tooltip = me_subject_independence.61.bt
		hidden_effect = {
			scope:unwilling_subject = {
				trigger_event = {
					id = me_subject_independence.63
				}
			}
		}
		# TODO ai calculation of this decision
	}
}

me_subject_independence.62 = {	# Response event - accepted
	type = country_event
	title = me_subject_independence.62.t
	desc = me_subject_independence.62.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:our_overlord.current_ruler

	option = {
		name = me_subject_independence.62.a
		custom_tooltip = me_subject_independence.62.at
		# TODO independence gain, truce and claims
	}
}

me_subject_independence.63 = {	# Response event - denied
	type = country_event
	title = me_subject_independence.63.t
	desc = me_subject_independence.63.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:our_overlord.current_ruler

	immediate = {
		declare_war_with_wargoal = {
			war_goal = independence_wargoal
			province = capital_scope
			target = scope:our_overlord
		}
		random_current_war = {
			limit = {
				any_war_participant = {
					this = scope:our_overlord
				}
				any_war_participant = {
					this = root
				}
				is_war_leader = root
			}
			save_scope_as = independence_war_scope
		}
		every_in_list = {
			list = confirmed_backers_list
			add_to_war = {
				target = scope:independence_war_scope
				attacker = yes
				leader = no
			}
			remove_from_list = confirmed_backers_list
		}
	}

	option = {
		name = me_subject_independence.63.a
		custom_tooltip = me_subject_independence.63.at
	}
}
## Mission 10 (Left) - Ultimatum - end