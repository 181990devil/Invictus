barbaricum_vandalia_lugia_mission = {	
##Tasks 7, 8, and 12 need events. Im not sure if the modifier on task 4 works.  Need to do tasks 5, 6, 9, and 15
#Tasks 3, 5, 7, 8, 9, 11, 12, 13, and 14 all need tooltips
    icon = rome_1
	header = mission_image_rome

    repeatable = no

    chance = {
        factor = 5
    }

    potential = {
        NOT = { has_variable = barbaricum_vandalia_lugia_mission }
        is_subject = no
        has_civil_war = no
		primary_culture = vandal
    }

    abort = {

    }

    on_start = {
        start_mission_ai_effect = yes
        save_scope_as = mission_country
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = barbaricum_vandalia_lugia_mission
            days = 7300
        }
    }

    on_completion = {
        complete_mission_effect = yes
    }

    barbaricum_vandalia_lugia_mission_task_1 = { # Silesian sanctuary
        icon = task_economical
		
		highlight = {
        	scope:province = {
				province_id = 4005
        	}
        }

        allow = {
			owns = 4005
			p:4005 = {
				is_holy_site = yes
			}
		}


        on_completion = {
			add_stability = 5
			add_country_modifier = {
				name = "barbaricum_mission_omen_modifier"
				duration = 5475
			}
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_2 = { # Face urn 
		requires = { barbaricum_vandalia_lugia_mission_task_1 }
        icon = task_economical

        allow = {
			owns = 4005
			treasury > 150
		}

		highlight = {
        	scope:province = {
				province_id = 4005
        	}
        }

        on_completion = {
			show_as_tooltip = {
                add_treasury = -150
                create_country_treasure = {
                    key = "vandal_face_urn"
                    icon = "treasure_chest"
                    modifier = {
                        local_pop_assimilation_speed = 0.1
						local_pop_conversion_speed_modifier = 0.15
                    }
                }
            }
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_3 = { # Amber road
        icon = task_economical

        allow = {
       		#Export to a country of Boian, Noric, or Vindelician culture
       		custom_tooltip = {
       		text = barbaricum_vandal_task_3_tooltip
       		OR = {
       		exports_to = BOA
       		exports_to = NRC
       		exports_to = EVS
       		exports_to = X19
       		exports_to = X18
       		exports_to = X17
       		}
       		}
		}
		
        on_completion = {
           #economic boost
          add_country_modifier = {
          	name = gallic_trade
          	duration = 1825	#5 Years
          }         
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_4 = { # Amber of our own
		requires = { barbaricum_vandalia_lugia_mission_task_3 }
        icon = task_conquest



        allow = {
			any_owned_province = {
			trade_goods = amber
			num_goods_produced = 3
			}			
        }

        on_completion = {
           any_owned_province = {
           	limit = {
           	trade_goods = amber
           	}
           	add_permanent_province_modifier = amber_production
           }
          #SET A RANDOM PROVINCE TO AMBER
			random_owned_province = {
			limit = {
				NOT = { trade_goods = grain }
				NOT = { trade_goods = dye }
				NOT = { trade_goods = vegetables }
				NOT = { trade_goods = gems }
				NOT = { trade_goods = amber }
				NOT = { trade_goods = precious_metals }
				NOT = { trade_goods = spices }
				NOT = { num_of_used_building_slots > 1 }
			} 
			set_trade_goods = amber
		}            			
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_5 = { # Contact with Gauls
		requires = { barbaricum_vandalia_lugia_mission_task_3 }
        icon = task_political

        allow = {
			#good relations >15 with Celts
			custom_tooltip = barbaricum_vandal_task_5_tooltip		
		}
		
		highlight = {

        }


        on_completion = {
			#diplomatic skills for ruler, maybe some country modifier?
			current_ruler = {
				add_trait = good_natured
				add_charisma = 2
			}
			add_country_modifier = {
				name = celtic_relations
				duration = 7300	#20 Years
			}
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_6 = { # Gaulish ritual
		requires = { barbaricum_vandalia_lugia_mission_task_5 }
        icon = task_political

        allow = {
			#sacrifice gold, have access to iron and precious metals
			any_owned_province = {
			trade_goods = iron
			}
			any_owned_province = {
			trade_goods = precious_metals
			}
			treasury >= 150
			political_influence >= 25								
		}
		
		highlight = {

        }


        on_completion = {
        	add_treasury = -150
        	add_political_influence = -25
			#better relations with Celts
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_7 = { # Warrior society of Lugus
		requires = { barbaricum_vandalia_lugia_mission_task_5 barbaricum_vandalia_lugia_mission_task_10 }
        icon = task_political
        duration = 180

        allow = {
			#good stability
			stability >= 60
			political_influence >= 50
			war = yes		
		}
		
		highlight = {

        }
        on_start = {
        custom_tooltip = barbaricum_vandal_task_7_tooltip
        #Offer each Vandal country vassilization
#        	trigger_event = { 
#			id = me_event_namespace
# 			}
        }

        on_completion = {
			#change religion to Celtic, stability hit, event to all Vandals to become subjects and convert too
			set_country_religion = druidism
        	add_political_influence = -50
        	add_stability = -40			
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_8 = { # Lugian confederacy
		requires = { barbaricum_vandalia_lugia_mission_task_7 }
        icon = task_political

        highlight = {
            
        }
		
		bypass = { has_completed_mission_task = barbaricum_vandalia_lugia_mission_task_12 }
		final = yes


        allow = {
           #all Vandals are subject, at least regional power >= 25 provinces  #Needs Tooltip
           num_of_provinces >= 25
		custom_tooltip = {
		text = barbaricum_vandal_task_8_A_tooltip
		NOT = {
			any_country = {
			NOT = { this = root }
			primary_culture = vandal
			NOT = { is_subject_of = root }
		}
		}
		}
        }

        on_completion = {
        custom_tooltip = barbaricum_vandal_task_8_B_tooltip
			#annex all Vandal subjects, become Lugia, change CoA and colour
#        	trigger_event = { 
#			id = me_event_namespace
# 			}			
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_9 = { # Suebian minority
        icon = task_political


        allow = {
			#integrated Irminonic = Suebian
			any_country_culture = {
				is_culture = suebian
				is_integrated = yes
			}
        }


        on_completion = {
        	custom_tooltip = barbaricum_vandal_task_9_tooltip
			#happiness bonus for Irminonic, opinion boost with Irminonic countries
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_10 = { # Suebian migrants
		requires = {  barbaricum_vandalia_lugia_mission_task_9 }
        icon = task_political
		
		duration = 180
		
        allow = {
			#integrated Irminonic
			any_country_culture = {
				is_culture = suebian
				is_integrated = yes
			}			
		}
		


        on_completion = {
          #migrants appear akin to Greek migrants for Diadochoi e.g. Seleukid mission tree
			p:6270 = {
            	while = {
              	count = 5
                    limit = {
                        total_population < population_cap
                    }
                        define_pop = {
                        type = tribesmen
                        culture = suebian
                        religion = root.religion
                        }
                    }
            	while = {
              	count = 3
                    limit = {
                        total_population < population_cap
                    }
                        define_pop = {
                        type = freemen
                        culture = suebian
                        religion = root.religion
                        }
                    }                    
				}         
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_11 = { # conquer Vandals
		requires = { barbaricum_vandalia_lugia_mission_task_3  }
        icon = task_conquest

        allow = {
			#all vandals are subjects
		custom_tooltip = {
		text = barbaricum_vandal_task_11_A_tooltip
		NOT = {
			any_country = {
			NOT = { this = root }
			primary_culture = vandal
			NOT = { is_subject_of = root }
		}
		}
		}			
		}

        on_completion = {
			#free claims on starting Vandal territory + Northern Silesia + Northern Lusatia
			custom_tooltip = barbaricum_vandal_task_11_B_tooltip
			hidden_effect = {
				area:elysia_area = { mission_area_claim_effect = yes }
				area:marsignia_area = { mission_area_claim_effect = yes }
				area:lugia_area = { mission_area_claim_effect = yes }
				area:galindia_area = { mission_area_claim_effect = yes }
				area:venedia_area = { mission_area_claim_effect = yes }
				area:helveconia_area = { mission_area_claim_effect = yes }				
			}
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_12 = { # Vandalia
		requires = { barbaricum_vandalia_lugia_mission_task_2 barbaricum_vandalia_lugia_mission_task_11 }
        icon = task_political

        allow = {
			#owns all of the starting Vandal territory + Northern Silesia + Northern Lusatia
			owns_or_subject_owns_area = elysia_area  
			owns_or_subject_owns_area = marsignia_area
			owns_or_subject_owns_area = lugia_area
			owns_or_subject_owns_area = galindia_area
			owns_or_subject_owns_area = venedia_area
			owns_or_subject_owns_area = helveconia_area
		}
		
		highlight = {
            scope:province = {
            	OR = {
                    is_in_area = elysia_area
					is_in_area = marsignia_area
					is_in_area = lugia_area
					is_in_area = galindia_area
					is_in_area = venedia_area 
					is_in_area = helveconia_area                  
            	}
            }
        }
		bypass = { has_completed_mission_task = barbaricum_vandalia_lugia_mission_task_8 }
		final = yes


        on_completion = {
        custom_tooltip = barbaricum_vandal_task_12_tooltip
			#annex Vandal vassals, become Vandalia
#        	trigger_event = { 
#			id = me_event_namespace
# 			}			
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_13 = { # colonise east
		requires = { barbaricum_vandalia_lugia_mission_task_7 barbaricum_vandalia_lugia_mission_task_12 }
        icon = task_political

        allow = {
			#colonise east = own areas
			owns_or_subject_owns_area = vistulia_area  
			owns_or_subject_owns_area = vistulia_inferioris_area
			owns_or_subject_owns_area = amadocia_occidentalis_area	
			owns_or_subject_owns_area = ossioia_area 		
		}

		highlight = {
            scope:province = {
            	OR = {
                    is_in_area = vistulia_area
					is_in_area = vistulia_inferioris_area
					is_in_area = amadocia_occidentalis_area 
					is_in_area = ossioia_area              
            	}
            }
        }
        on_completion = {
			#some form of development boost for eastern areas
			custom_tooltip = barbaricum_vandal_task_13_tooltip
			hidden_effect = {
            	area:vistulia_area = {
                	every_area_province = { 
                		add_permanent_province_modifier = {
                		name = eastern_economic_boost
                		}
                	}
            	}
            	area:vistulia_inferioris_area = {
                	every_area_province = { 
                		add_permanent_province_modifier = {
                		name = eastern_economic_boost
                		}
                	}
            	}
            	area:amadocia_occidentalis_area = {
                	every_area_province = { 
                		add_permanent_province_modifier = {
                		name = eastern_economic_boost
                		}
                	}
            	}
            	area:ossioia_area = {
                	every_area_province = { 
                		add_permanent_province_modifier = {
                		name = eastern_economic_boost
                		}
                	}
            	}            	            	            	
        	}			
        }
    }
	
	barbaricum_vandalia_lugia_mission_task_14 = { # conquest of Pannonia
		requires = { barbaricum_vandalia_lugia_mission_task_7 barbaricum_vandalia_lugia_mission_task_12 }
        icon = task_conquest

        allow = {
			#conquer the land the Vandals held later in Pannonia
		owns_or_subject_owns_area = ciscarpathia_area
		owns_or_subject_owns_area = transcarpathia_centralis_area
		owns_or_subject_owns_area = transcarpathia_occidentalis_area	
		}

		highlight = {
            scope:province = {
            	OR = {
                    is_in_area = ciscarpathia_area
					is_in_area = transcarpathia_centralis_area
					is_in_area = transcarpathia_occidentalis_area               
            	}
            }
        }
        on_completion = {
			#claims on surrounding areas
			custom_tooltip = barbaricum_vandal_task_14_tooltip
			hidden_effect = {
            	area:iazygia_majoris_area = {
                	every_area_province = { 
                		add_claim = ROOT 
                	}
            	}
            	area:pannonia_terminus_area = {
                	every_area_province = { 
                		add_claim = ROOT 
                	}
            	}
            	area:pannonia_valeria_area = {
                	every_area_province = { 
                		add_claim = ROOT 
                	}
            	}
            	area:pannonia_prima_orientalis_area = {
                	every_area_province = { 
                		add_claim = ROOT 
                	}
            	}
            	area:carnuntia_area = {
                	every_area_province = { 
                		add_claim = ROOT 
                	}
            	}
            	area:transcarpathia_orientalis_area = {
                	every_area_province = { 
                		add_claim = ROOT 
                	}
            	}            	            	            	            	            	
        	}			
        }
    }
	
	
	barbaricum_vandalia_lugia_mission_task_15 = { # manufactories (tyniec and mines)
		requires = { barbaricum_vandalia_lugia_mission_task_3 }
        icon = task_economical

        allow = {
			#build settlement buildings or cities in earthenware/mine - Lesser Poland / Silesia
		}


        on_completion = {
			#economic boost for provinces
        }
    }

    
}
