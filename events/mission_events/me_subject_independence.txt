namespace = me_subject_independence

## Mission 1 - Internal discussion of independence - start
me_subject_independence.1 = {
    type = country_event
    title = me_subject_independence.1.t
    desc = me_subject_independence.1.desc
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = scope:random_left_advisor
	right_portrait = scope:random_right_advisor

    option = {      
        name = me_subject_independence.1.a
		custom_tooltip = me_subject_independence.1.at
    }
}

me_subject_independence.2 = {	# Discussion which path should be taken
	type = country_event
	hidden = yes

	immediate = {
		if = {	# Discussion continues
			limit = {
				var:discussion_progress < 5
				is_subject = yes
			}
			random_list = {
				1 = {	# Complication event - Left side forces their argument
					trigger = {
						NOT = {
							has_variable = left_forced
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_forced
						days = 60
					}
					change_variable = {
						name = left_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.3
					}
				}
				1 = {	# Complication event - Right side forces their argument
					trigger = {
						NOT = {
							has_variable = right_forced
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_forced
						days = 40
					}
					change_variable = {
						name = right_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.3
					}
				}
				2 = {	# Complication event - Left side objects
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					trigger_event = {
						id = me_subject_independence.4
					}
				}
				2 = {	# Complication event - Right side objects
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					trigger_event = {
						id = me_subject_independence.4
					}
				}
				2 = {	# Complication event - Left side bribes
					trigger = {
						NOT = {
							has_variable = left_bribed
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_bribed
						days = 60
					}
					trigger_event = {
						id = me_subject_independence.5
					}
				}
				2 = {	# Complication event - Right side bribes
					trigger = {
						NOT = {
							has_variable = right_bribed
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_bribed
						days = 60
					}
					trigger_event = {
						id = me_subject_independence.5
					}
				}
				2 = {	# Complication event - Left side brilliant speech
					trigger = {
						NOT = {
							has_variable = left_speeched
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_speeched
						days = 60
					}
					trigger_event = {
						id = me_subject_independence.6
					}
				}
				2 = {	# Complication event - Right side brilliant speech
					trigger = {
						NOT = {
							has_variable = right_speeched
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_speeched
						days = 60
					}
					trigger_event = {
						id = me_subject_independence.6
					}
				}
				1 = {	# Complication event - Left side makes promises
					trigger = {
						NOT = {
							has_variable = left_promised
						}
					}
					scope:random_left_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = left_check
						days = 15
					}
					set_variable = {
						name = left_promised
						days = 60
					}
					change_variable = {
						name = left_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.7
					}
				}
				1 = {	# Complication event - Right side makes promises
					trigger = {
						NOT = {
							has_variable = right_promised
						}
					}
					scope:random_right_advisor = {
						save_scope_as = selected_advisor
					}
					set_variable = {
						name = right_check
						days = 15
					}
					set_variable = {
						name = right_promised
						days = 60
					}
					change_variable = {
						name = right_argument_points
						add = 1
					}
					trigger_event = {
						id = me_subject_independence.7
					}
				}
			}
			change_variable = {
				name = discussion_progress
				add = 1
			}
			trigger_event = {
				id = me_subject_independence.2
				days = { 26 36 }
			}
		}
		else_if = {	# Discussion finished
			limit = {
				var:discussion_progress >= 5
				is_subject = yes
			}
			if = {	# Left side superior
				limit = {
					var:left_argument_points > var:right_argument_points
				}
				set_variable = {
					name = left_won
				}
			}
			else_if = {	# Right side superior
				limit = {
					var:left_argument_points < var:right_argument_points
				}
				set_variable = {
					name = right_won
				}
			}
			else = {	# Stalemate
				set_variable = {
					name = stalemate_won
				}
			}
			hidden_effect = {
				remove_variable = discussion_progress
				remove_variable = left_argument_points
				remove_variable = right_argument_points
			}
		}
		else = {	# Fallback cleanup
			hidden_effect = {
				remove_variable = discussion_progress
				remove_variable = left_argument_points
				remove_variable = right_argument_points
			}
		}
	}
}

me_subject_independence.3 = {	# Discussion event - A side forces their argument
	type = country_event
	title = me_subject_independence.3.t
    desc = me_subject_independence.3.desc	# TODO add differences to which side is forcing their argument
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor
	
	option = {
		name = me_subject_independence.3.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.3.at_l
		}
		else = {
			custom_tooltip = me_subject_independence.3.at_r
		}
	}
}

me_subject_independence.4 = {	# Discussion event - A side objects
	type = country_event
	title = me_subject_independence.4.t
    desc = me_subject_independence.4.desc	# TODO add differences to which side is forcing their argument
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {	# Agree with the objecting side
		name = me_subject_independence.4.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.4.at_l
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.4.at_r
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = loyalty_medium
		}
	}

	option = {	# Disagree with the objecting side
		name = me_subject_independence.4.b
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.4.bt_l
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.4.bt_r
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = subtract_loyalty_medium
		}
	}
}

me_subject_independence.5 = {	# Discussion event - A side attempts a bribe
	type = country_event
	title = me_subject_independence.5.t
    desc = me_subject_independence.5.desc	# TODO add differences to which side is forcing their argument
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {	# Take the bribe
		name = me_subject_independence.5.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.5.at_l
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.5.at_r
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_gold = -200
			add_loyalty = loyalty_medium
		}
		current_ruler = {
			add_gold = 200
			add_popularity = subtract_popularity_large
			add_corruption = corruption_large
		}
	}

	option = {	# Don't take the bribe
		name = me_subject_independence.5.b
		custom_tooltip = me_subject_independence.5.bt
		scope:selected_advisor = {
			add_loyalty = subtract_loyalty_small
			add_popularity = subtract_popularity_large
		}
		current_ruler = {
			add_popularity = popularity_large
		}
	}
}

me_subject_independence.6 = {	# Discussion event - A side makes a brilliant speech
	type = country_event
	title = me_subject_independence.6.t
    desc = me_subject_independence.6.desc	# TODO add differences to which side is forcing their argument
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {	# Join in with popular opinion
		name = me_subject_independence.6.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.6.at_l
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.6.at_r
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = loyalty_medium
		}
	}

	option = {	# Poke holes in flawed argument
		name = me_subject_independence.6.b
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.6.bt_l
			hidden_effect = {
				change_variable = {
					name = right_argument_points
					add = 1
				}
			}
		}
		else = {
			custom_tooltip = me_subject_independence.6.bt_r
			hidden_effect = {
				change_variable = {
					name = left_argument_points
					add = 1
				}
			}
		}
		scope:selected_advisor = {
			add_loyalty = subtract_loyalty_medium
		}
		current_ruler = {
			add_popularity = subtract_loyalty_large
		}
	}
}

me_subject_independence.7 = {	# Discussion event - A side makes beautiful promises
	type = country_event
	title = me_subject_independence.7.t
    desc = me_subject_independence.7.desc	# TODO add differences to which side is forcing their argument
    picture = senate_debate	# TODO adjust for different governments and cultures
    left_portrait = current_ruler
	right_portrait = scope:selected_advisor

	option = {
		name = me_subject_independence.7.a
		if = {
			limit = {
				has_variable = left_check
			}
			custom_tooltip = me_subject_independence.7.at_l
		}
		else = {
			custom_tooltip = me_subject_independence.7.at_r
		}
	}
}

me_subject_independence.10 = {	# Resolution event - Left side wins
	type = country_event
	title = me_subject_independence.10.t
	desc = me_subject_independence.10.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:random_left_advisor

	option = {
		name = me_subject_independence.10.a
		custom_tooltip = me_subject_independence.10.at
		hidden_effect = {
			set_variable = {
				name = left_won
			}
		}
	}
}

me_subject_independence.11 = {	# Resolution event - Right side wins
	type = country_event
	title = me_subject_independence.11.t
	desc = me_subject_independence.11.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = current_ruler
	right_portrait = scope:random_right_advisor

	option = {
		name = me_subject_independence.11.a
		custom_tooltip = me_subject_independence.11.at
		hidden_effect = {
			set_variable = {
				name = right_won
			}
		}
	}
}

me_subject_independence.12 = {	# Resolution event - Stalemate
	type = country_event
	title = me_subject_independence.12.t
	desc = me_subject_independence.12.desc
	picture = senate_debate	# TODO adjust for different governments and cultures
	left_portrait = scope:random_left_advisor
	right_portrait = scope:random_right_advisor

	option = {
		name = me_subject_independence.12.a
		custom_tooltip = me_subject_independence.12.at
	}
}
## Mission 1 - Internal discussion of independence - end