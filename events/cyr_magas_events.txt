namespace = cyr_magas_01

cyr_magas_01.1 = { # Task 1 - A New Governor for Cyrenaica - Start
    type = country_event
    title = cyr_magas_01.1.t
    desc = cyr_magas_01.1.desc
    picture = greek_court

    trigger = {
        is_subject = no        
    }


    option = {      
        name = cyr_magas_01.1.a
    c:EGY = {
            add_opinion = {
                modifier = requesting_govenor
                target = ROOT
            }
        }
    }
}

cyr_magas_01.2 = { # Task 1 - A New Governor for Cyrenaica - Magas Appointed
    type = country_event
    title = cyr_magas_01.2.t
    desc = cyr_magas_01.2.desc
    picture = diadochi_coronation
    left_portrait = scope:cyr_magas_magas_scope
    right_portrait = char:18 

    trigger = {

        c:CYR = { 
            NOT ={
                current_ruler = char:46
            }
        }
        NOT = { 
            char:46 = {is_alive = no} 
        }
    }


    immediate = {
        if = {
            c:EGY = {
            limit = {
                char:46 = { # Magas
                    is_alive = yes
                    employer = root
                    prisoner = no
                }
            }
            char:46 = { save_scope_as = cyr_magas_magas_scope } # Magas
            }
        }
        current_ruler = { save_scope_as = cyr_magas_old_ruler }
    }

    option = {      
        name = cyr_magas_01.2.a
        hidden_effect = {
            scope:cyr_magas_magas_scope = {
                remove_all_positions = yes
                move_country = c:CYR
                set_home_country = c:CYR
                remove_character_modifier = foreign_citizen
            }
        }
        set_as_ruler = scope:cyr_magas_magas_scope
        create_family = scope:cyr_magas_magas_scope
        
    }
}

cyr_magas_01.3 = { # Task 1 - A New Governor for Cyrenaica - End
    type = country_event
    title = cyr_magas_01.3.t
    desc = cyr_magas_01.3.desc
    picture = greek_court

    option = {      
        name = cyr_magas_01.3.a
        add_alliance =  c:EGY
        add_country_modifier = {
                name = independent_egyptian_subject
                duration = -1
        }	
    }
}


cyr_magas_01.4 = { # Egyptian Ties- Alliance Broken
    type = country_event
    title = cyr_magas_01.4.t
    desc = cyr_magas_01.4.desc
    picture = greeks_marching
    
    trigger = {
        c:CYR = {
        has_country_modifier = independent_egyptian_subject
        }
        c:CYR = {
        NOT =  {alliance_with = c:EGY}
        }
    }

    option = {      
        name = cyr_magas_01.4.a
        c:EGY ={
            declare_war_with_wargoal ={
                war_goal = conquer_wargoal
                province = c:CYR.capital_scope
                target = c:CYR
             }
        }
        c:EGY = {
            add_opinion = {
                modifier = cyr_independence_opinion
                target = ROOT
            }
        }
        c:CYR = {
            remove_country_modifier = independent_egyptian_subject
            
        }

    }
}

#cyr_magas_01.5 = { # Egyptian Ties- Tribute Demanded
#    type = country_event
#    title = cyr_magas_01.5.t
#    desc = cyr_magas_01.5.desc
#    picture = greek_court
#    
#    
#    trigger = {
#        Root = c:CYR
#        Root = {has_country_modifier = independent_egyptian_subject}
#        Root = {
#            alliance_with = c:EGY
#        }
#    }
#
#    immediate ={
#            random_country_state = {
#                limit = {
#                    has_state_food > 200
#                }
#               save_scope_as = CYR_EGY_food_tribute
#            }
#        
#
#    }
#
#    option = {      
#        name = cyr_magas_01.5.a
#
#        scope:CYR_EGY_food_tribute = { add_state_food = -200}
#        ROOT = {
#
#            add_treasury = {
#                value = has_monthly_income
#                multiply = -4
#            }
#            add_manpower = -5
#        }
#        
#    }
#
#    option = {      
#        name = cyr_magas_01.5.b
#        ROOT = {break_alliance = c:EGY}
#        c:EGY = {
#            add_opinion = {
#                modifier = CYR_egyptian_ties_denied
#                target = ROOT
#            }
#        }
#    }
#}


cyr_magas_01.6 = {               # Approaching Potential Allies 
    type = country_event
    title = cyr_magas_01.6.t
    desc = cyr_magas_01.6.desc
    picture = greek_court
    
    
    trigger = {
        Root = c:CYR
    }

    immediate =  {       
        random_country ={
            limit = {
                country_culture_group = hellenic 
                num_of_cities >= 50
                is_subject = no
                NOT = {tag = EGY}
                NOT = {has_variable = cyr_embassy_received}
                NOT = {tag = CYR}
            }
            save_scope_as = magas_diplomacy_scope
        }
    }

    option = {      
        name = cyr_magas_01.6.a  # No involvement
        
        scope:magas_diplomacy_scope = {
            add_opinion = {
                modifier = CYR_indep_diplo_neg
                target = ROOT
            }
            set_variable = cyr_embassy_received
        }

    }

    option = {      
        name = cyr_magas_01.6.b  # Basic Opinion bonus

        scope:magas_diplomacy_scope = {
            add_opinion = {
                modifier = CYR_indep_diplo_small
                target = ROOT
            }
            set_variable = cyr_embassy_received
        }
    }

    option = {      
        name = cyr_magas_01.6.c    # Large Opinion Bonus
    
        scope:magas_diplomacy_scope = {
            add_opinion = {
                modifier = CYR_indep_diplo_large
                target = ROOT
            }
            set_variable = cyr_embassy_received
        }
        ROOT = {
            add_treasury = {
                value = has_monthly_income
                multiply = -8
            }
        }

    }

}

cyr_magas_01.7 = {              # Royal Marriage 
    type = country_event
    title = cyr_magas_01.7.t
    desc = cyr_magas_01.7.desc
    picture = religious_rite
    left_portrait = scope:cyr_royal_marriage_groom
    right_portrait = scope:cyr_royal_marriage_bride
    
    trigger = {

   }

    immediate ={       
        root.current_ruler = {
            save_scope_as = cyr_royal_marriage_groom 
        }
        scope:cyr_royal_marriage_country = {
            random_character = {
                limit = { 
                   is_female = yes
                   from_ruler_family = yes
                   age < 30
                   is_adult = yes
                }
                save_scope_as = cyr_royal_marriage_bride
            }
        }
    }

    option = {      
        name = cyr_magas_01.7.a
        
        scope:cyr_royal_marriage_bride = {  
            if = {
                limit = { is_married = yes }
                spouse = { save_scope_as = cyr_royal_marriage_bride_spouse }
                divorce_character = spouse
            }
            move_country = c:CYR
            hidden_effect = { 
                remove_character_modifier = foreign_citizen
                set_home_country = c:CYR 
                set_as_minor_character = scope:cyr_royal_marriage_bride
            }
        }
        scope:cyr_royal_marriage_groom = {
            if = {
                limit = { is_married = yes }
                spouse = { save_scope_as = cyr_royal_marriage_groom_spouse }
                divorce_character = spouse
            }
        }
        scope:cyr_royal_marriage_groom = {
            marry_character = scope:cyr_royal_marriage_bride
        }
        add_alliance = scope:cyr_royal_marriage_country
        scope:cyr_royal_marriage_country = {
            add_opinion = {
                modifier = CYR_royal_marriage
                target = ROOT
            }
        }
        if = {
            limit = {
                scope:cyr_royal_marriage_country = { alliance_with = c:EGY }
            }
            scope:cyr_royal_marriage_country = { break_alliance = c:EGY }
        }
   }

}



cyr_magas_01.8 = {          # Indian ties event 
    type = country_event
    title = cyr_magas_01.8.t
    desc = cyr_magas_01.8.desc
    picture = pataliputra
    left_portrait = char:46
    right_portrait = c:MRY.current_ruler
    
    
    trigger = {

   }

    immediate ={       

    }

    option = {      
        name = cyr_magas_01.8.a
        add_country_modifier = {
            name = "cyr_indian_herbalism"
            duration = -1
        }
        add_research = { technology = civic_tech value = 25 } 
        c:MRY = {
            add_opinion = {
                modifier = CYR_buddhist_embassies
                target = ROOT
            }
        }
        hidden:c:MRY = {
            create_country_treasure = { 
                key = "cyr_rock_edict"
                icon = "treasure_chest"
                
                modifier = {
                    local_happiness_for_same_religion_modifier  = 0.05
                    local_migration_attraction    = 2
                }
            }
        }        
   }

    option = {      
        name = cyr_magas_01.8.b

        add_research = { technology = religious_tech value = 80 }
        create_character = {
            first_name = "Hegesias"
            family_name = "Peisithanatos"
            age = 25
            no_stats = yes
            culture = root.culture
            religion = root.religion
            save_scope_as = death_persuader
        }
        hidden_effect = {
            scope:death_persuader = {
                add_martial = 2
                add_charisma = 10
                add_finesse = 14
                add_zeal = 7
                add_trait = scholar
                add_trait = polymath
                add_trait = intelligent
                add_prominence = 50
            }
        }
        custom_tooltip = cyr_magas_01.8.b.ttt

        custom_tooltip = cyr_magas_01.8.b.tt
        hidden:ROOT.capital_scope = {
            every_pops_in_province = {
                random = {
                    chance = 5
                    set_pop_religion = buddhism
                }
            }
        }

        trigger_event = {
            id = cyr_magas_01.12
            days = { 20 180 }
        }
        c:MRY = {
            add_opinion = {
                modifier = CYR_buddhist_embassies
                target = ROOT
            }
        }        
        hidden:c:MRY = {
            create_country_treasure = { 
                key = "cyr_rock_edict"
                icon = "treasure_chest"
                
                modifier = {
                    local_happiness_for_same_religion_modifier  = 0.05
                    local_migration_attraction    = 2
                }
            }
        } 
   }

    option = {      
        name = cyr_magas_01.8.c
        
        add_political_influence = -200
        add_stability = -20
        add_country_modifier = {
            name = "recent_convert_modifier"
            duration = 3650
            }
        set_country_religion = buddhism
        current_ruler = {
            if = {
                limit = {
                    NOT = { has_religion = buddhism }
                }
                set_character_religion = buddhism
            }
        }
        hidden_effect = {
            current_ruler.family = {
                every_family_member = {
                    limit = {
                        employer = ROOT
                        NOT = { has_religion = buddhism }
                    }
                    set_character_religion = buddhism
                }
            }
        }
        ordered_character = {
            limit = {
                loyalty >= 50
                NOT = { has_religion = buddhism }
                is_ruler = no
                from_ruler_family = no
            }
            max = 10
            order_by = prominence
            set_character_religion = buddhism
        }
        hidden_effect = {
            every_character = {
                limit = { 
                    NOT = { 
                        has_same_religion_as = employer.current_ruler 
                    } 
                }
                add_loyalty = -10
            }
        }
        custom_tooltip = cyr_magas_01.8.c.tt
        hidden:ROOT.capital_scope = {
            every_pops_in_province = {
                random = {
                    chance = 10
                    set_pop_religion = buddhism
                }
            }
        }
        hidden:c:MRY = {
            create_country_treasure = { 
                key = "cyr_rock_edict"
                icon = "treasure_chest"
                
                modifier = {
                    local_happiness_for_same_religion_modifier  = 0.05
                    local_migration_attraction    = 2
                }
            }
        } 
    }

}



cyr_magas_01.9 = {          # CYR Independence Wae
    type = country_event
    title = cyr_magas_01.9.t
    desc = cyr_magas_01.9.desc
    picture = elephant_battle
    
    
    trigger = {

   }

    immediate ={       

    }

    option = {      
        name = cyr_magas_01.9.a

        c:EGY ={
            declare_war_with_wargoal ={
                war_goal = conquer_wargoal
                province = c:CYR.capital_scope
                target = c:CYR
             }
        }
        c:EGY = {
            add_opinion = {
                modifier = cyr_independence_opinion
                target = ROOT
            }
        }
        c:CYR = {
            remove_country_modifier = independent_egyptian_subject
            
        }        

   }


}


cyr_magas_01.10 = {          # Looking for allies
    type = country_event
    title = cyr_magas_01.10.t
    desc = cyr_magas_01.10.desc
    picture = throneroom
    left_portrait = c:CYR.current_ruler
    right_portrait = c:EGY.current_ruler
    
    
    trigger = {
        ROOT = c:CYR
   }

    immediate ={       

    }

    option = {      
        name = cyr_magas_01.10.a

        c:CYR = {
            add_country_modifier = {
            name = cyr_looking_for_allies
            duration = 1825
            }
            
        }        

   }


}


cyr_magas_01.11 = {          # Coronation Flavour
    type = country_event
    title = cyr_magas_01.11.t
    desc = cyr_magas_01.11.desc
    picture = diadochi_coronation
    left_portrait = c:CYR.current_ruler

    option = {      
        name = cyr_magas_01.11.a
        c:CYR = {
            current_ruler = {
                add_popularity = 15
            }
        }

   }


}

cyr_magas_01.12 = {          # death-persuader
    type = country_event
    title = cyr_magas_01.12.t
    desc = cyr_magas_01.12.desc
    picture = great_library
    left_portrait = scope:death_persuader


    option = {      
        name = cyr_magas_01.12.a
        create_country_treasure = { 
            key = "cyr_death_by_starvation"
            icon = "treasure_chest"
            
            modifier = {
                local_unrest = -2
                local_research_points_modifier   = 0.10
            }
        }

   }


}
