namespace = cultural_revolt_inv

cultural_revolt_inv.1 = { #looking for cultures ready to revolt
	type = country_event
	immediate = {
		every_country_culture = {
			limit = {
				is_integrated = no
                NOT = {
                    has_country_culture_modifier = revolting_culture
                }
			}
			save_scope_as = target_revolted_culture
            #save_scope_as = target_annexed_culture
            
            # root = {
            #     trigger_event = { id = cultural_revolt_inv.2 }
            # }
            
			random_list = {
				600 = {}
				2 = {
					modifier = {
                        factor = 5
                        scope:target_revolted_culture = {
                            country_culture_pop_count >= 40
                        }
                    }
					modifier = {
                        factor = 2
                        scope:target_revolted_culture = {
                            country_culture_pop_count >= 150
                        }
                    }
					modifier = {
                        factor = 2
                        scope:target_revolted_culture = {
                            country_culture_pop_count >= 500
                        }
                    }
					modifier = {
                        factor = 0.5
                        scope:target_revolted_culture = {
                            OR = {
                                has_country_culture_modifier = administrators_cultmodifier
                                has_culture_group = root.culture.culture_group
                            }
                            
                        }
                    }
					modifier = {
                        factor = 0.8
                        scope:target_revolted_culture = {
                            has_country_culture_modifier = inheritance_right
                        }
                    }
					modifier = {
                        factor = 0.8
                        scope:target_revolted_culture = {
                            OR = {
                                has_country_culture_modifier = right_of_marriage
                                has_country_culture_modifier = torture_protection
                            }
                            
                        }
                    }
					modifier = {
                        factor = 1.4
                        scope:target_revolted_culture = {
                            OR = {
                                has_country_culture_modifier = colonia_founded
                                has_country_culture_modifier = despised_annexed_culture
                            }
                            
                        }
                    }
					modifier = {
                        factor = 1.2
                        scope:target_revolted_culture = {
                            has_country_culture_modifier = slave_rights_imposed
                            has_country_culture_modifier = rights_revoked
                        }
                    }
					modifier = {
                        factor = 1.2
                        scope:target_revolted_culture = {
                            stability < 40
                        }
                    }
					modifier = {
                        factor = 1.3
                        scope:target_revolted_culture = {
                            stability < 30
                        }
                    }
					modifier = {
                        factor = 1.4
                        scope:target_revolted_culture = {
                            stability < 20
                        }
                    }
					modifier = {
                        factor = 2
                        scope:target_revolted_culture = {
                            stability < 10
                        }
                    }
                    root = {
                        trigger_event = { 
                            id = cultural_annexed_revolt.2
                            days = {1 360}
                        }
                    }
				}
			}
		}
	}

}

cultural_revolt_inv.2 = {
    type = country_event
    title = "cultural_revolt_event.2.t"
    desc = "cultural_revolt_event.2.desc" 
    picture = proscription
    goto_location = scope:random_province_revolted_cult
    left_portrait = scope:revolted_prov_gov 

    immediate = {
        if = {
            limit = { 
                any_governorships = {
                    governor_or_ruler = {
                        NOT = { has_culture = scope:target_revolted_culture.culture }
                        OR = {
                            finesse >= 10
                            has_trait = prominent 
                            has_trait = silver_tongued 
                            has_trait = wise
                        }
                    }
                    any_governorship_state = {
                        any_state_province = {
                            dominant_province_culture = scope:target_revolted_culture.culture	
                        }
                    }
                }
            }
            
            random_governorships = {
                limit = {
                
                    governor_or_ruler = {
                        NOT = { has_culture = scope:target_revolted_culture.culture }
                        OR = {
                            finesse >= 10
                            has_trait = prominent 
                            has_trait = silver_tongued 
                            has_trait = wise
                        }
                    }
                    any_governorship_state = {
                        any_state_province = {
                            dominant_province_culture = scope:target_revolted_culture.culture	
                        }
                    }
                }
                governor_or_ruler = { 
                    save_scope_as = revolted_prov_gov
                    random_governor_state = {
                        limit = {
                            any_state_province = {
                                dominant_province_culture = scope:target_revolted_culture.culture	
                            }
                        }
                        random_state_province = {
                            limit = {
                                dominant_province_culture = scope:target_revolted_culture.culture
                            }
                            weight = {
                                modifier = {
                                    add = total_population
                                }
                            }
                            save_scope_as = random_province_revolted_cult
                        }
                    }
                }

            }
        }
        else = {
            random_country_state = {
                limit = {
                    any_state_province = {
                        dominant_province_culture = scope:target_annexed_culture.culture	
                    }
                
                }
                random_state_province = {
                    limit = {
                        dominant_province_culture = scope:target_annexed_culture.culture
                    }
                    weight = {
                        modifier = {
                            add = total_population
                        }
                    }
                    save_scope_as = random_province_unhappy_cult
                }
                if = {
                    limit = {
                        exists = governor_or_ruler
                    }
                    governor_or_ruler = {
                        save_scope_as = unhappy_prov_gov
                    }
                }
                else = {
                    root = {
                        current_ruler = {
                            save_scope_as = unhappy_prov_gov
                        }
                    }
                }
                
            
            }

        }
           
    }

    
    option = {
        name = omg_test_event.a
    }
}

