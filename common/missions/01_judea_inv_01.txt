judea_inv_mission = {
    header = "mission_image_sparta"
    icon = "general_3"
    repeatable = no

    chance = {
        factor = 3
    }

    potential = {
        OR = {
            tag = JUD
            tag = SMA
            tag = ISR
        }
        religion = judaism
        NOT = { has_variable = judea_mission_cooldown }
    }
    abort = {
        NOT = { religion = judaism }
    }
    on_start = {
        add_country_modifier = {
            name = judea_modifier_8
            duration = 18250 #50 yrs
        }
    }

    on_abort = {
        custom_tooltip = judea_mission_abortion.tt
        set_variable = { 
            name = judea_mission_cooldown
            days = 3650
        }
        remove_country_modifier = judea_modifier_8
    }

    on_completion = {
        complete_mission_effect = yes
        remove_country_modifier = judea_modifier_8
    }

    judea_inv_mission_task_1 = {
        icon = "task_conquest"

        allow = {
            OR = {
                p:660 = {
                    OR = {
                        AND = {
                            has_building = temple_building
                            has_building = library_building
                        }
                        AND = {
                            dominant_province_culture = hebrew
                            dominant_province_religion = judaism
                            total_population >= 35
                        }
                    }
                }
                p:659 = {
                    OR = {
                        AND = {
                            has_building = temple_building
                            has_building = library_building
                        }
                        AND = {
                            dominant_province_culture = hebrew
                            dominant_province_religion = judaism
                            total_population >= 35
                        }
                    }
                }
                p:722 = {
                    OR = {
                        AND = {
                            has_building = temple_building
                            has_building = library_building
                        }
                        AND = {
                            dominant_province_culture = hebrew
                            dominant_province_religion = judaism
                            total_population >= 35
                        }
                    }
                }
                p:670 = {
                    OR = {
                        AND = {
                            has_building = temple_building
                            has_building = library_building
                        }
                        AND = {
                            dominant_province_culture = hebrew
                            dominant_province_religion = judaism
                            total_population >= 35
                        }
                    }
                }
            }
        }

        on_completion = {
            add_1_free_province_investments = yes
            add_treasury = 100
        }

    }
    judea_inv_mission_task_2 = {
        icon = "task_economical"

        requires = { judea_inv_mission_task_1 }

        allow = {
            OR = {
                p:660 = {
                    has_holy_site = yes
                }
                p:659 = {
                    has_holy_site = yes
                }
                p:722 = {
                    has_holy_site = yes
                }
                p:670 = {
                    has_holy_site = yes
                }
            }
        }

        on_completion = {
            add_country_modifier = {
                name = judea_modifier_3
                duration = 3650 #10 yrs
            }
        }

    }
    judea_inv_mission_task_3 = {
        icon = "task_economical"

        duration = 365

        requires = { judea_inv_mission_task_2 }

        allow = {
            treasury >= 100
            any_owned_province = {
                is_holy_site = yes
                has_city_status = no
            }
        }

        on_start = {
            add_treasury = -100
        }

        on_completion = {
            random_owned_province = {
                limit = {
                    is_holy_site = yes
                    has_city_status = no
                }
                set_city_status = city
                add_province_modifier = {
                    name = judea_modifier_4
                    duration = -1
                }
            } 
        }

    }
    judea_inv_mission_task_4 = {
        icon = "task_political"

        requires = { judea_inv_mission_task_20 judea_inv_mission_task_9 }

        allow = {
            deity:omen_david = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_solomon = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_moses = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_esther = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_samuel = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_ezra = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_abraham = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_deborah = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_joseph = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_daniel = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_ezekiel = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_caleb_joshua = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
        }

        on_completion = { #to do: make it that it's only Jewish holy sites
            every_province = {
                limit = {
                    is_holy_site = yes
                }
                add_province_modifier = {
                    name = judea_modifier_6
                    duration = 18250 #50 yrs
                }
            }
        }

    }
    judea_inv_mission_task_5 = {
        icon = "task_expansion"

        highlight = {
            scope:province = {
                OR = {
                    province_id = 742 #Kadasa
                    province_id = 687 #Jersualem
                    province_id = 683 #Ephraim
                    province_id = 680 #Shekhem
                    province_id = 691 #Hebron
                }
            }
        }

        allow = {
            owns = 742 #Kadasa
            owns = 687 #Jersualem
            owns = 683 #Ephraim
            owns = 680 #Shekhem
            owns = 691 #Hebron
        }

        on_completion = {
            p:790 = { #Antigoneia
                add_claim = root
            }
            p:818 = { #Edessa Assyrias
                add_claim = root
            }
            p:754 = { #Palmyra
                add_claim = root
            }
            p:862 = { #Nineveh
                add_claim = root
            }
            p:883 = { #Assur
                add_claim = root
            }
            add_country_modifier = {
                name = judea_modifier_1
                duration = 3650 #10 yrs
            }
        }

    }
    judea_inv_mission_task_6 = {
        icon = "task_conquest"

        requires = { judea_inv_mission_task_5 }

        highlight = {
            scope:province = {
                OR = {
                    province_id = 754 #Palmyra
                    province_id = 818 #Edessa Assyrias
                    province_id = 790 #Antigoneia
                    province_id = 862 #Nineveh
                    province_id = 883 #Assur
                }
            }
        }

        allow = {
            owns = 754 #Palmyra
            OR = {
                owns = 818 #Edessa Assyrias
                owns = 790 #Antigoneia
            }
            OR = {
                owns = 862 #Nineveh
                owns = 883 #Assur
            }
        }

        bypass = {
            p:922 = { #Aqola
                owner = root
            }
            p:942 = {#Apologos
                owner = root
            }
            owns_or_subject_owns_region = mesopotamia
        }

        on_completion = {
            region:mesopotamia = {
                every_region_province = {
                    limit = {
                        NOT = {
                            owner = root
                        }
                        has_owner = yes
                    }
                    add_claim = root
                }
            }
        }

    }
    judea_inv_mission_task_7 = {
        icon = "task_expansion"

        requires = { judea_inv_mission_task_6 }

        highlight = {
            scope:province = {
                OR = {
                    province_id = 922 #Aqola
                    province_id = 942 #Apologos
                }
            }
        }

        allow = {
            owns = 922 #Aqola
            owns = 942 #Apologos
        }

        on_completion = {
            add_country_modifier = {
                name = judea_modifier_7
                duration = 7300 #20 yrs
                capital_scope = {
                    create_state_pop = citizen
                    create_state_pop = noble
                }
            }
        }

    }
    judea_inv_mission_task_8 = { #Sus and Ekbatana
        icon = "task_conquest"

        requires = { judea_inv_mission_task_7 }

        highlight = {
            scope:province = {
                OR = {
                    province_id = 946 #Susa
                    province_id = 1595 #Ekbatana
                }
            }
        }

        allow = {
            owns = 946 #Susa
            owns = 1595 #Ekbatana
        }

        on_completion = {
            add_country_modifier = {
                name = judea_modifier_9
                duration = -1
            }
        }
    }
    judea_inv_mission_task_9 = { #All Holy Sites
        icon = "task_political"

        duration = 365

        requires = { judea_inv_mission_task_3 judea_inv_mission_task_8 judea_inv_mission_task_13 }

        allow = {
            political_influence >= 50
            treasury >= 200
            deity:omen_david = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_solomon = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_moses = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_esther = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_samuel = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_ezra = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_abraham = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_deborah = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_joseph = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_daniel = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_ezekiel = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
            deity:omen_caleb_joshua = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                }
            }
        }

        on_start = {
            add_political_influence = -50
            add_treasury = -300
        }

        on_completion = { #to do: make it that it's only Jewish holy sites
            trigger_event = {
                id = judea_inv.2
                days = -1
            }
            every_owned_province = {
                limit = {
                    is_holy_site = yes
                }
                add_province_modifier = {
                    name = judea_modifier_5
                    duration = -1
                }
            }
        }

    }
    judea_inv_mission_task_10 = { #Every Holy Site has a temple
        icon = "task_economical"
        final = yes

        requires = { judea_inv_mission_task_9 }

        allow = {
            deity:omen_david = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_solomon = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_moses = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_esther = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_samuel = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_ezra = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_abraham = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_deborah = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_joseph = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_daniel = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_ezekiel = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
            deity:omen_caleb_joshua = {
                has_holy_site = yes
                holy_site = {
                    owner = root
                    has_building = temple_building
                }
            }
        }

        on_completion = {
            add_country_modifier = {
                name = judea_modifier_5
                duration = -1
            }
        }

    }
    judea_inv_mission_task_11 = { #Oros Chorib
        icon = "task_conquest"

        requires = { judea_inv_mission_task_5 }

        hightlight = {
            scope:province = {
                province_id = 1693 #Oros Chorib
            }
        }

        allow = {
            p:1693 = { #Oros Chorib
                owner = root
                dominant_province_culture = hebrew
                dominant_province_religion = judaism
            }
        }

        on_completion = {
            add_country_modifier = {
                name = judea_modifier_11
                duration = 3650 #10 yrs
            }
        }

    }
    judea_inv_mission_task_12 = { #Own Sinai
        icon = "task_expansion"

        requires = { judea_inv_mission_task_11 }

        highlight = {
            scope:area = {
                OR = {
                    is_in_area = eastern_delta_area
                    is_in_area = sinai_area
                }
            }
        }

        allow = {
            political_influence >= 25
            owns_area = eastern_delta_area 
            owns_area = sinai_area
        }

        on_completion = {
            add_political_influence = -25
            create_country_treasure = {
                key = ark_of_the_covenant
                icon = ark_of_covenant 
                modifier = {
                    local_population_happiness = 0.15 #temporary
                }
            }
        }

    }
    judea_inv_mission_task_13 = { #Pilousion
        icon = "task_economical"

        requires = { judea_inv_mission_task_12 }

        hightlight = {
            scope:province = {
                province_id = 509 #Pilousion
            }
        }

        allow = {
            p:509 = {
                owner = root
                num_of_fortress_building >= 3
                total_population >= 30
            }
        }

        on_completion = {
            p:509 = {
                add_province_modifier = {
                    name = judea_modifier_13
                    duration = -1
                }
            }
        }

    }
    judea_inv_mission_task_14 = { #Nabataea may become a subject
        icon = "task_diplomatic"

        requires = { judea_inv_mission_task_12 }

        duration = 180

        allow = {
            treasury >= 200
            political_influence >= 25
            exists = c:NBT
            c:NBT = {
                is_subject = no
            }
        }

        bypass = {
            NOT = { exists = c:NBT}
        }

        on_completion = {
            add_political_influence = -25
            add_treasury = -200
            #offer to become subject. Nabataea will get an event to accept/refuse, based on opinion
        }

    }
    judea_inv_mission_task_15 = {
        icon = "task_expansion"

        requires = { judea_inv_mission_task_14 }

        allow = {
            owns_or_subject_owns_area = arabia_relicta_area
        }

        on_completion = {
            region:arabia = {
                every_region_province = {
                    limit = {
                        NOT = {
                            owner = root
                        }
                        has_owner = yes
                    }
                    add_claim = root
                }
            }
        }

    }
    judea_inv_mission_task_16 = {
        icon = "task_diplomatic"

        requires = { judea_inv_mission_task_15 }

        allow = {
            exists = c:SHB
            c:SHB = {
                is_subject_of = root
            }
        }

        on_completion = {
            deity:omen_solomon = {
                has_holy_site = yes
                holy_site = {
                    add_province_modifier = {
                        name = judea_modifier_14
                        duration = -1
                    }
                }
            }
        }

    }
    judea_inv_mission_task_17 = {
        icon = "task_conquest"

        requires = { judea_inv_mission_task_15 }

        allow = {
            owns_or_subject_owns_region = arabia
        }

        on_completion = {
            random_owned_province = {
                limit = {
                    trade_goods = incense
                    has_city_status = no
                }
            }
            increase_province_rank_effect = yes
            create_state_pop = freemen
            create_state_pop = citizen
            create_state_pop = citizen
            create_state_pop = noble
        }

    }
    judea_inv_mission_task_18 = { #Join the Diadochi war
        icon = "task_political"
        duration = 90
        
        requires = { judea_inv_mission_task_19 }

        #monthly_on_action = judea_events_pulse

        allow = {
            NOT = { has_variable = antigonus_death }
            any_current_war = {
                war_leader = c:EGY 
                target = c:PRY
            }
        }

        on_completion = {
            trigger_event = {
                id = judea_inv.1
                days = -1
            }
        }
    }
    judea_inv_mission_task_19 = {
        icon = "task_political"

        allow = {
            political_influence >= 25
        }

        on_completion = {
            add_political_influence = -25
            region:palestine = {
                every_region_province = {
                    limit = {
                        NOT = {
                            owner = ROOT
                        }    
                        province_dominant_culture_group = west_levantine
                    }
                    add_provincial_modifier = {
                        name = judea_modifier_2
                        duration = 3650 #10 yrs
                    }
                }
            }
        }
    }
    judea_inv_mission_task_20 = {
        icon = "task_economical"

        duration = 365 

        requires = { judea_inv_mission_task_3 }

        allow = {
            political_influence >= 50
            treasury >= 150
            capital_scope = {
                has_city_status = yes
                has_building = library_building
                OR = {
                    has_building = academy_building
                    has_building = court_building
                }
                OR = {
                    has_building = theathre_building
                    has_building = foundry_building
                }
                num_free_building_slots = 0
            }
        }

        on_start = {
            trigger_event = {
                id = judea_inv.3
                days = { 75 150 }
            }
            trigger_event = {
                id = judea_inv.4
                days = { 175 250 }
            }
            trigger_event = {
                id = judea_inv.5
                days = { 300 350}
            }
        }

        on_completion = {
            add_political_influence = -50
            add_treasury = -150
            increase_province_rank_effect = yes
        }

    }
    judea_inv_mission_task_21 = { #Optionally Raze Babylon
        icon = "task_conquest"

        requires = { judea_inv_mission_task_7 }

        allow = {
            p:918 = {
                has_city_status = no
            }
            total_population < 30
        }

        on_completion = {
            add_treasury = 500
            add_political_influence = 50
            add_aggressive_expansion = 10
            p:918 = {
                add_province_modifier = {
                    name = judea_modifier_12
                    duration = -1
                }
                create_state_pop = slave
                create_state_pop = slave
            }
        }
    }
}
