judea_inv_mission = {
    header = "mission_image_sparta"
    icon = "general_3"
    repeatable = no

    chance = {
        factor = 3
    }

    potential = {
        OR = {
            tag = JUD
            tag = SMA
            tag = ISR
        }
        religion = judaism
        NOT = { has_variable = judea_mission_cooldown }
    }
    abort = {
        NOT = { religion = judaism }
    }
    on_start = {
        save_scope_as = mission_country
        add_country_modifier = {
            name = judea_modifier_8
            duration = 18250 #50 yrs
        }
    }

    on_abort = {
        custom_tooltip = judea_mission_abortion.tt
        set_variable = { 
            name = judea_mission_cooldown
            days = 3650
        }
        remove_country_modifier = judea_modifier_8
    }

    on_completion = {
        complete_mission_effect = yes
        remove_country_modifier = judea_modifier_8
    }

    judea_inv_mission_task_1 = {
        icon = "task_conquest"

        allow = {
            any_province = {
                OR = {
                    is_in_area = galilee_area
                    is_in_area = samaria_area
                    is_in_area = judea_area
                    is_in_area = philistia_area
                    is_in_area = decapolis_area
                }
                owns = ROOT
                total_population >= 30
                is_holy_site = no
            }
        }

        on_completion = {
            add_1_free_province_investments = yes
        }

    }
    judea_inv_mission_task_2 = {
        icon = "task_economical"

        requires = { judea_inv_mission_task_1 }

        allow = {
            OR = {
                deity:omen_solomon = {
                    has_holy_site = yes
                }
                deity:omen_david = {
                    has_holy_site = yes
                }
            }
        }

        on_completion = {
            add_country_modifier = {
                name = judea_modifier_3
                duration = 3650
            }
        }

    }
    judea_inv_mission_task_3 = {
        icon = "task_economical"

        duration = 365

        requires = { judea_inv_mission_task_2 }

        allow = {
            any_owned_province = {
                is_holy_site = yes
                has_city_status = no
            }
        }

        on_start = {
            random_owned_province = {
                limit = {
                    is_holy_site = yes
                    has_city_status = no
                }
            }
            save_scope_as = holy_city
        }

        on_completion = {
            scope:holy_city = {
                set_city_status = city
                add_province_modifier = {
                    name = judea_modifier_4
                    duration = -1
                }
            } 
        }

    }
    judea_inv_mission_task_4 = {
        icon = "task_political"

        requires = { judea_inv_mission_task_20 judea_inv_mission_task_9 }

        allow = {
            deity:omen_david = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_solomon = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_moses = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_esther = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_samuel = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_ezra = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_saul = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_abraham = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_deborah = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_joshua = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_joseph = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_daniel = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_ezekiel = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
            deity:omen_caleb_joshua = {
                has_holy_site = yes
                holy_site = {
                    num_province_treasures > 0
                }
            }
        }

        on_completion = { #make it that it's only Jewish holy sites
            every_province = {
                limit = {
                    is_holy_site = yes
                }
                add_province_modifier = {
                    name = judea_modifier_6
                    duration = -1
                }
            }
        }

    }
    judea_inv_mission_task_5 = {
        icon = "task_expansion"

        highlight = {
            scope:province = {
                OR = {
                    province_id = 742 #Kadasa
                    province_id = 687 #Jersualem
                    province_id = 683 #Ephraim
                    province_id = 680 #Shekhem
                    province_id = 691 #Hebron
                }
            }
        }

        allow = {
            owns = 742 #Kadasa
            owns = 687 #Jersualem
            owns = 683 #Ephraim
            owns = 680 #Shekhem
            owns = 691 #Hebron
        }

        on_completion = {
            p:790 = { #Antigoneia
                add_claim = root
            }
            p:818 = { #Edessa Assyrias
                add_claim = root
            }
            p:754 = { #Palmyra
                add_claim = root
            }
            p:862 = { #Nineveh
                add_claim = root
            }
            p:883 = { #Assur
                add_claim = root
            }
            add_country_modifier = {
                name = judea_modifier_1
                duration = 3650 #10 yrs
            }
        }

    }
    judea_inv_mission_task_6 = {
        icon = "task_conquest"

        requires = { judea_inv_mission_task_5 }

        highlight = {
            scope:province = {
                OR = {
                    province_id = 754 #Palmyra
                    province_id = 818 #Edessa Assyrias
                    province_id = 790 #Antigoneia
                    province_id = 862 #Nineveh
                    province_id = 883 #Assur
                }
            }
        }

        allow = {
            owns = 754 #Palmyra
            OR = {
                owns = 818 #Edessa Assyrias
                owns = 790 #Antigoneia
            }
            OR = {
                owns = 862 #Nineveh
                owns = 883 #Assur
            }
        }

        on_completion = {
            region:mesopotamia = {
                every_region_area = {
                    add_provincial_claim_effect = yes
                }
            }
        }

    }
    judea_inv_mission_task_7 = {
        icon = "task_expansion"

        requires = { judea_inv_mission_task_6 }

        highlight = {
            scope:province = {
                OR = {
                    province_id = 922 #Aqola
                    province_id = 942 #Apologos
                }
            }
        }

        allow = {
            owns = 922 #Aqola
            owns = 942 #Apologos
        }

        on_completion = {
            add_country_modifier = {
                name = judea_modifier_7
                duration = 7300 #20 yrs
            }
        }

    }
    judea_inv_mission_task_8 = {
        icon = "task_conquest"

        requires = { judea_inv_mission_task_7 }

    }
    judea_inv_mission_task_9 = { #All Holy Sites
        icon = "task_political"

        duration = 365

        requires = { judea_inv_mission_task_3 judea_inv_mission_task_8 judea_inv_mission_task_13 }

        allow = {
            political_influence >= 50
            treasury >= 200
            deity:omen_david = {
                has_holy_site = yes
            }
            deity:omen_solomon = {
                has_holy_site = yes
            }
            deity:omen_moses = {
                has_holy_site = yes
            }
            deity:omen_esther = {
                has_holy_site = yes
            }
            deity:omen_samuel = {
                has_holy_site = yes
            }
            deity:omen_ezra = {
                has_holy_site = yes
            }
            deity:omen_saul = {
                has_holy_site = yes
            }
            deity:omen_abraham = {
                has_holy_site = yes
            }
            deity:omen_deborah = {
                has_holy_site = yes
            }
            deity:omen_joshua = {
                has_holy_site = yes
            }
            deity:omen_joseph = {
                has_holy_site = yes
            }
            deity:omen_daniel = {
                has_holy_site = yes
            }
            deity:omen_ezekiel = {
                has_holy_site = yes
            }
            deity:omen_caleb_joshua = {
                has_holy_site = yes
            }
        }

        on_start = {
            add_political_influence = -50
            add_treasury = -300
        }

        on_completion = {
            trigger_event = {
                id = judea_inv.2
                days = -1
            }
            every_province = {
                limit = {
                    is_holy_site = yes
                }
                add_province_modifier = {
                    name = judea_modifier_5
                    duration = -1
                }
            }
        }

    }
    judea_inv_mission_task_10 = {
        icon = "task_economical"
        final = yes

        requires = { judea_inv_mission_task_9 }

    }
    judea_inv_mission_task_11 = {
        icon = "task_conquest"

        requires = { judea_inv_mission_task_5 }

    }
    judea_inv_mission_task_12 = {
        icon = "task_expansion"

        requires = { judea_inv_mission_task_11 }

    }
    judea_inv_mission_task_13 = {
        icon = "task_economical"

        requires = { judea_inv_mission_task_12 }

    }
    judea_inv_mission_task_14 = {
        icon = "task_diplomatic"

        requires = { judea_inv_mission_task_12 }

    }
    judea_inv_mission_task_15 = {
        icon = "task_expansion"

        requires = { judea_inv_mission_task_14 }

    }
    judea_inv_mission_task_16 = {
        icon = "task_diplomatic"

        requires = { judea_inv_mission_task_15 }

    }
    judea_inv_mission_task_17 = {
        icon = "task_conquest"

        requires = { judea_inv_mission_task_15 }

    }
    judea_inv_mission_task_18 = { #Join the Diadochi war
        icon = "task_political"
        duration = 90
        
        requires = { judea_inv_mission_task_19 }

        #monthly_on_action = judea_events_pulse

        on_completion = {
            trigger_event = {
                id = judea_inv.1
            }
        }
    }
    judea_inv_mission_task_19 = {
        icon = "task_political"

        allow = {
            political_influence >= 25
        }

        on_completion = {
            add_political_influence = -25
            region:palestine = {
                every_region_province = {
                    limit = {
                        OR = {
                            is_in_area = samaria_area
                            is_in_area = galilee_area
                            is_in_area = decapolis_area
                            is_in_area = philistia_area
                            is_in_area = judea_area
                        }
                        NOT = {
                            owner = ROOT
                        }    
                        province_dominant_culture_group = west_levantine
                    }
                    add_provincial_modifier = {
                        name = judea_modifier_2
                        duration = 3650 #10 yrs
                    }
                }
            }
        }
    }
    judea_inv_mission_task_20 = {
        icon = "task_economical"

        requires = { judea_inv_mission_task_3 }

    }
    judea_inv_mission_task_21 = {
        icon = "task_conquest"

        requires = { judea_inv_mission_task_7 }

        allow = {
            scope:province = {
                province_id = 918 #Babylon
                NOT = { 
                    has_city_status = city 
                }
            }
        }
    }
}
